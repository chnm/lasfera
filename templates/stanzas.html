{% extends "base.html" %}
{% load static %}

{% block title %}Stanzas - La Sfera{% endblock title %}

{% block content %}
  <div class="flex">
    <section id="introduction" class="container mx-auto p-4 my-10 flex-grow">
      <h3 class="text-2xl pb-8" id="text">
        Text of the manuscript</a>
    </h3>

    <div class="prose">
      {% for stanza in stanzas %}
        <div>
          <span class="font-serif text-red-700 text-sm mr-2">
            {{ stanza.stanza_line_code_starts }}
          </span>
          <span>
            {{ stanza.stanza_text|safe }}
          </span>
        </div>
      {% endfor %}
    </div>
  </section>

  <div class="w-1/2 p-4">
    <div id="iiif-viewer" style="width: 100%; height: 600px;"></div>
  </div>

  <!-- Sidebar -->
  <div id="sidebar" class="fixed right-0 top-0 h-full w-64 bg-white p-4 transform translate-x-full overflow-auto transition-transform duration-200 ease-in-out shadow-left">
    <button id="close-button" class="mb-4 bg-red-500 text-white p-2 rounded">&times;</button>
    <p id="notation-text"></p>
  </div>
  </div>
{% endblock content %}

{% block scripts %}
  <script src="{% static 'js/stanza.js' %}"></script>
  <script src="https://unpkg.com/mirador@latest/dist/mirador.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.1.1/openseadragon.min.js" integrity="sha512-LbaoUnRCul2C+I4cdS/EMnMbynmZMU58AApBnZkhMzp/r8rOS7htjTsox7g6rf5ZXkSx56F5dDYmhLwqV1Zt4A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    const viewer = OpenSeadragon({
      id: "iiif-viewer",
      preserveViewport: true,
      visibilityRatio:    1,
      minZoomLevel:       1,
      defaultZoomLevel:   1,
      sequenceMode:       true,
      tileSources:   [{
        "@context": "http://iiif.io/api/image/2/context.json",
        "@id": "https://libimages1.princeton.edu/loris/pudl0001%2F4609321%2Fs42%2F00000001.jp2",
        "height": 7200,
        "width": 5233,
        "profile": [ "http://iiif.io/api/image/2/level2.json" ],
        "protocol": "http://iiif.io/api/image",
        "tiles": [{
          "scaleFactors": [ 1, 2, 4, 8, 16, 32 ],
          "width": 1024
        }]
      }]
    });
  </script>
{% endblock scripts %}
